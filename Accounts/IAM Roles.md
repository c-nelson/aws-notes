
A role is also an identity like [IAM Users](IAM%20Users.md). Unlike [IAM Roles](IAM%20Roles.md), _roles can_ be referenced within a [resource policy](Identity%20Policies.md).

Typically used when there are an unknown amount of users, or multiple principals.

If you can't identify the number of users for an identity, an IAM Role is likely the solution.

Generally used on a temporary basis. You borrow the permissions for a short amount of time.

![Pasted image 20250204203443.png](_atts/Pasted%20image%2020250204203443.png)

## Policies
![Pasted image 20250204204752.png](_atts/Pasted%20image%2020250204204752.png)

If a role gets assumed by something that is allowed, then AWS generates Temporary Security Credentials (like [access keys](IAM.md#Access%20Keys) but expire in a short time). Then, gives those credentials to the identity. When expired, the identity would need to re-assume the role to get another set of Temporary Security Credentials.

Temporary Security Credentials are generated by the [STS](../Misc/STS.md) AWS service. The operation used is `sts:AssumeRole`.

#### Trust Policy
Controls which identities can assume that role.

Can reference:
- Identities in the same account
	- other IAM Users or 
	- Other Roles
	- Services
- Identities from other AWS [Accounts](Accounts.md)
- Can allow anonymous usage of role
- Facebook, twitter, google identities
#### Permissions Policy
Defines what resources the identity that assumes the role can access.


## When to use Roles

#### Services

Most commonly used for AWS Services themselves. The services need access to other services to operate.

Create a role for a service to assume permissions to do its needed actions. This is better than hard coding permissions into the service for security reasons and/or causes problems when access keys change.

Example with [Lambda](../Lambda/Lambda.md):
![Pasted image 20250204210759.png](_atts/Pasted%20image%2020250204210759.png)

#### Emergencies

For "break glass" situations. When a user needs access to something they normally do not. For example, a 24/7 help desk would typically only need read permissions but in rare cases may need write access.

#### Adding AWS to existing environments
Use role to reuse existing identities from other accounts.

![Pasted image 20250204212005.png](_atts/Pasted%20image%2020250204212005.png)

For example, if a company already uses Microsoft Active Directory for logins, you can use roles to allow SSO (single sign-on) via the Microsoft identities.

External can't be used directly, that's where roles come in. #AWSCommonTest 

Giving external accounts the permissions to assume an IAM Role is called ID Federation. It allows for easier managing of users.

#### Applications with many users
There can only be 5000 [IAM Users](IAM%20Users.md) within an AWS [Account](Accounts.md). Web Identity Federation can be used to assume a role. This is how many public applications allow sign-in, for example when you see "sign in via google, twitter, facebook, etc".

![Pasted image 20250204212744.png](_atts/Pasted%20image%2020250204212744.png)

#AWSCommonTest ID Federation with IAM Roles is a way to scale to number of users.

## Cross AWS Account Access
![Pasted image 20250204213133.png](_atts/Pasted%20image%2020250204213133.png)